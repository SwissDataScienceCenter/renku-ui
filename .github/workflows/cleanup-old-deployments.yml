name: Cleanup old deployments

on:
  workflow_dispatch:

jobs:
  cleanup-old-deployments-from-github:
    runs-on: ubuntu-24.04
    steps:
      - uses: actions/checkout@v5
        with:
          fetch-depth: 0
      - uses: actions/github-script@v8
        with:
          github-token: ${{ secrets.RENKUBOT_GITHUB_TOKEN }}
          script: |
            const script = require('./.github/workflows/cleanup-old-deployments.js')
            await script({ core, github })
